<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

    <record id="crm_phonecall_search" model="ir.ui.view">
        <field name="name">crm.phonecall.search</field>
        <field name="model">crm.phonecall</field>
        <field name="inherit_id" ref="crm_phone.crm_phonecall_search"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='opportunity_id']" position="after">
                <field name="hr_applicant_id"/>
            </xpath>
        </field>
    </record>

    <record id="hr_applicant_phonecall" model="ir.ui.view">
        <field name="name">hr_recruitment_phone.hr_applicant.form</field>
        <field name="model">hr.applicant</field>
        <field name="inherit_id" ref="hr_recruitment_phone.crm_case_form_view_job"/>
        <field name="arch" type="xml">
            <field name="message_ids" widget="mail_thread" position="replace"/>

            <xpath expr="//button[@name='action_makeMeeting']" position="before">
                <button class="oe_inline oe_stat_button" type="action"
                    name="%(crm_phone.crm_phonecall_action)d"
                    icon="fa-phone"
                    context="{'search_default_hr_applicant_id': active_id}">
                    <field string="Calls" name="phonecall_count" widget="statinfo"/>
                </button>
            </xpath>
            <xpath expr="//field[@name='description']" position="after">
                <notebook>
                    <page string="Internal Notes">
                       <field name="message_ids" widget="mail_thread"/>
                    </page>
                    <page string="Communication">
                       <field name="phonecall_ids" mode="tree" readonly="1">
                           <tree string="Phonecalls" create="false" delete="false"
                                   colors="gray:state in ('done', 'cancelled')">
                                <field name="date"/>
                                <field name="end_date"/>
                                <field name="name"/>
                                <field name="partner_phone"/>
                                <field name="user_id" context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'base.group_sale_salesman_all_leads']}"/>
                                <field name="direction"/>
                                <field name="state"/>
                            </tree>
                        </field>
                    </page>
                </notebook>
            </xpath>
        </field>
    </record>

</data>
</openerp>
